<!DOCTYPE html/>
<html>
<head>
	<title>Запись результатов</title>
	<meta charset="utf-8">
	<style>
	input.points {
		font-family: Verdana, Arial Black, Helvetica, sans-serif; 
		font-weight:bolder; 
		font-size : 60pt;/* Размер шрифта в пунктах */ 
		width : 180px;
		height : 120px;
		/*border:solid 2 black;*/
		border-radius: 30px;
		box-shadow: 5px 5px 10px 2px rgba(0,0,0,0.7);
	}
	span.info {
		font-family: Verdana, Arial Black, Helvetica, sans-serif; 
		font-size : 44pt;
		color: #000000;
		padding: 1px;
		margin : 2px;
	}
	div.info {
		font-family: Verdana, Arial Black, Helvetica, sans-serif; 
		font-size : 60pt;
		color: #FFFF00;
		padding:5px;
		text-align:center;
		border:solid 3px black;
		border-radius: 30px;
		box-shadow: 5px 5px 10px 2px rgba(0,0,0,0.7);
		-webkit-touch-callout: none;
		-webkit-user-select: none;
		-khtml-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		user-select: none;
	}
	table {
		background-color:#DDDDDD;
		font-size : 40pt;
		text-align: center;
		/*position: fixed;
		left:0;
		top:0;*/
	}
    </style>

</head>
<body style='background-color:#AAAAAA'>
	<div  style='font-size : 36pt;'>
		<a href='index.html'>НА ГЛАВНУЮ</a>
	</div>
	</br>
	<div style="padding:2px;"><b>
		<span class='info'>Группа</span>
		<span class='info' style="background-color:#FFFFFF" id='group'>0</span>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		<span class='info' >Мишень</span>
		<span class='info' style="background-color:#FFFFFF" id='target' padding=10>0</span>
		<span id='targetType' hidden>Field</span>
		</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		<input class='points' style='background-color:#88FF88;' type="button" value="&nbsp;&#10155;&nbsp;"  onclick="nextTarget()"></input>
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		<input class='points' style='background-color:#FF8888; font-size:30pt; width:90px; height:60px;' 
				type="button" value="&nbsp;&#8617;&nbsp;"  onclick="prevTarget()"></input>
	</div>
	</br>
	<div class='info' style="background-color:#FF0000" id='ready' padding=5 onclick='sendReady()'>ГРУППА НЕ ГОТОВА</div>
	</br>
	<!--table border=3 cellpadding=5 style='background-color:#DDDDDD; font-size : 40pt;'-->
	<table border=1 cellpadding=5'>
		<tr style="background-color:#444444; color:#DDDDDD; text-align: center">
			<td >Имя</td><td width=80>1</td><td width=80>2</td><td id="onlyField" width=80>3</td>
			<td style='font-size : 20pt;' width=85>Сумма</td>
			<td style='font-size : 20pt;' width=105 >Нараст. итог</td>
		<tr>
			<td id="name1" style="text-align: left"></td>
			<td id="11" onclick="setPoints(this.id)"></td>
			<td id="12" onclick="setPoints(this.id)"></td>
			<td id="13" onclick="setPoints(this.id)"></td>
			<td id="summ1"></td><td id="integ1"></td>
		</tr>
		<tr>
			<td id="name2" style="text-align: left"></td>
			<td id="21" onclick="setPoints(this.id)"></td>
			<td id="22" onclick="setPoints(this.id)"></td>
			<td id="23" onclick="setPoints(this.id)"></td>
			<td id="summ2"></td><td id="integ2"></td>
		</tr>
		<tr>
			<td id="name3" style="text-align: left"></td>
			<td id="31" onclick="setPoints(this.id)"></td>
			<td id="32" onclick="setPoints(this.id)"></td>
			<td id="33" onclick="setPoints(this.id)"></td>
			<td id="summ3"></td><td id="integ3"></td>
		</tr>
		<tr>
			<td id="name4" style="text-align: left"></td>
			<td id="41" onclick="setPoints(this.id)"></td>
			<td id="42" onclick="setPoints(this.id)"></td>
			<td id="43" onclick="setPoints(this.id)"></td>
			<td id="summ4"></td><td id="integ4"></td>
		</tr>
	</table>

	<!--div style="width : 600px; height : 400px;padding:2px;background-color:#AAAAAA" id='out'-->
		
	</div>
	</br>
	<div id='3dButton'>
		<input id="11" class='points' style='background-color:#FFFF00' type="button" value="11"  onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="10" class='points' style='background-color:#FFFF00' type="button" value="10"  onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="8"  class='points' style='background-color:#FF0000' type="button" value="8"   onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="5"  class='points' style='background-color:#00AAFF' type="button" value="5"   onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="0"  class='points' style='background-color:#FFFFFF' type="button" value="M"   onclick="setPoint2Cell(this.id)"></input>
	</div>
	<div id='FieldButton'>
		<input id="6" class='points' style='background-color:#FFFF00' type="button" value="6"  onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="5" class='points' style='background-color:#FFFF00' type="button" value="5"  onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="4" class='points' style='background-color:#000000; color:#FFDD00;' type="button" value="4"   onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="3" class='points' style='background-color:#000000; color:#FFDD00;' type="button" value="3"   onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="2" class='points' style='background-color:#000000; color:#FFDD00;' type="button" value="2"   onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="1" class='points' style='background-color:#000000; color:#FFDD00;' type="button" value="1"   onclick="setPoint2Cell(this.id)"></input>
		&nbsp;
		<input id="0" class='points' style='background-color:#FFFFFF;' type="button" value="M"   onclick="setPoint2Cell(this.id)"></input>
	</div>
	<script>
	let qArrows = 3;
	const qArhers = 4;
	let target = 0;
	let row = 1;
	let arrow = 1;
	document.getElementById('11').style.backgroundColor = "#00ffff";

	function setPoints(thisId){
		let targetType = document.getElementById('targetType').innerHTML;
		if(targetType == '3D') qArrows = 2;
		else qArrows = 3;
		
		row = 100;
		arrow = 100;
		
		for(let i = 1; i <= qArhers; i++){
			for(let j = 1; j <= qArrows; j++){
				let genId = i + "" + j;
				if(genId == thisId){
					document.getElementById(genId).style.backgroundColor = "#00ffff";
					row = i;
					arrow = j;
				}
				else document.getElementById(genId).style.backgroundColor = "#DDDDDD";
			}
		}
	}
	
	function setPoint2Cell(points){
		if(row == 0 || arrow == 0) return;
		let request = {};
		request['name'] = document.getElementById('name'+row).innerHTML;
		request['target'] = parseInt(document.getElementById('target').innerHTML);
		request['row'] = row;
		request['arrow'] = arrow;
		request['points'] = parseInt(points);
		wsRequest('setPoint2Cell',request);
		let targetType = document.getElementById('targetType').innerHTML;
		if(targetType == '3D') qArrows = 2;
		else qArrows = 3;
		arrow++;
		if(arrow > qArrows){
			if(row < qArhers && document.getElementById('name'+(row+1)).innerHTML != ""){
				arrow = 1;
				row++;
			}else{
				arrow = 100;
				row = 100;
			}
		}
		setPoints(row + "" + arrow);
	}
	function sendReady(){
		if(confirm('Вы уверены, что группа готова к стрельбе?')) wsRequest('sendReady','');
	}
	
	function prevTarget(){
		if(document.getElementById('ready').innerHTML != ALL_READY){
			alert('Нельзя переключаться на следующую мишень, пока нет разрешения стрельбы');
			return;
		}
		if(confirm('Вы уверены, что хотите вернуться на предыдущую мишень?')){
			let request = {};
			request['group'] = document.getElementById('group').innerHTML;
			wsRequest(PREV_TARGET,request);
			row = 100;
			arrow = 100;
			setPoints(row + "" + arrow);
		}
	}
	
	function nextTarget(){
		if(document.getElementById('ready').innerHTML != ALL_READY){
			alert('Нельзя переключаться на следующую мишень, пока нет разрешения стрельбы');
			return;
		}
		if(row < 11){
			alert('Не все стрелы записаны');
			return;
		}
		let request = {};
		request['group'] = document.getElementById('group').innerHTML;
		wsRequest(NEXT_TARGET,request);
		row = 1;
		arrow = 1;
		setPoints(row + "" + arrow);
	}
	</script> 
	<script type="text/javascript" src="srClient.js"></script> 
	<script type="text/javascript" src="const.js"></script> 
	<script type="text/javascript" src="clientTools.js"></script> 
</body>
</html>